{"dependencies":[{"name":"babel-runtime/helpers/defineProperty","loc":{"line":1,"column":28}},{"name":"babel-runtime/helpers/extends","loc":{"line":2,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"lodash/set","loc":{"line":5,"column":16}},{"name":"./createFormField","loc":{"line":6,"column":45}},{"name":"./utils","loc":{"line":7,"column":74}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){return 0===t.indexOf(e)&&-1!==[\".\",\"[\"].indexOf(t[e.length])}function i(e){return new v(e)}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=i;var l=require(\"babel-runtime/helpers/defineProperty\"),r=e(l),n=require(\"babel-runtime/helpers/extends\"),u=e(n),a=require(\"babel-runtime/helpers/classCallCheck\"),s=e(a),d=require(\"babel-runtime/helpers/createClass\"),f=e(d),o=require(\"lodash/set\"),c=e(o),F=require(\"./createFormField\"),h=e(F),g=require(\"./utils\"),v=function(){function e(t){(0,s.default)(this,e),m.call(this),this.fields=this.flattenFields(t),this.fieldsMeta={}}return(0,f.default)(e,[{key:\"updateFields\",value:function(e){this.fields=this.flattenFields(e)}},{key:\"flattenFields\",value:function(e){return(0,g.flattenFields)(e,function(e,t){return(0,F.isFormField)(t)},\"You must wrap field data with `createFormField`.\")}},{key:\"flattenRegisteredFields\",value:function(e){var t=this.getAllFieldsName();return(0,g.flattenFields)(e,function(e){return t.indexOf(e)>=0},\"You cannot set field before registering it.\")}},{key:\"setFields\",value:function(e){var t=this,i=this.fieldsMeta,l=(0,u.default)({},this.fields,e),r={};Object.keys(i).forEach(function(e){return r[e]=t.getValueFromFields(e,l)}),Object.keys(r).forEach(function(e){var i=r[e],n=t.getFieldMeta(e);if(n&&n.normalize){var a=n.normalize(i,t.getValueFromFields(e,t.fields),r);a!==i&&(l[e]=(0,u.default)({},l[e],{value:a}))}}),this.fields=l}},{key:\"resetFields\",value:function(e){var t=this.fields;return(e?this.getValidFieldsFullName(e):this.getAllFieldsName()).reduce(function(e,i){var l=t[i];return l&&\"value\"in l&&(e[i]={}),e},{})}},{key:\"setFieldMeta\",value:function(e,t){this.fieldsMeta[e]=t}},{key:\"getFieldMeta\",value:function(e){return this.fieldsMeta[e]=this.fieldsMeta[e]||{},this.fieldsMeta[e]}},{key:\"getValueFromFields\",value:function(e,t){var i=t[e];if(i&&\"value\"in i)return i.value;var l=this.getFieldMeta(e);return l&&l.initialValue}},{key:\"getValidFieldsName\",value:function(){var e=this,t=this.fieldsMeta;return t?Object.keys(t).filter(function(t){return!e.getFieldMeta(t).hidden}):[]}},{key:\"getAllFieldsName\",value:function(){var e=this.fieldsMeta;return e?Object.keys(e):[]}},{key:\"getValidFieldsFullName\",value:function(e){var t=Array.isArray(e)?e:[e];return this.getValidFieldsName().filter(function(e){return t.some(function(t){return e===t||(0,g.startsWith)(e,t)&&[\".\",\"[\"].indexOf(e[t.length])>=0})})}},{key:\"getFieldValuePropValue\",value:function(e){var t=e.name,i=e.getValueProps,l=e.valuePropName,n=this.getField(t),u=\"value\"in n?n.value:e.initialValue;return i?i(u):(0,r.default)({},l,u)}},{key:\"getField\",value:function(e){return(0,u.default)({},this.fields[e],{name:e})}},{key:\"getNotCollectedFields\",value:function(){var e=this;return this.getValidFieldsName().filter(function(t){return!e.fields[t]}).map(function(t){return{name:t,dirty:!1,value:e.getFieldMeta(t).initialValue}}).reduce(function(e,t){return(0,c.default)(e,t.name,(0,h.default)(t))},{})}},{key:\"getNestedAllFields\",value:function(){var e=this;return Object.keys(this.fields).reduce(function(t,i){return(0,c.default)(t,i,(0,h.default)(e.fields[i]))},this.getNotCollectedFields())}},{key:\"getFieldMember\",value:function(e,t){return this.getField(e)[t]}},{key:\"getNestedFields\",value:function(e,t){return(e||this.getValidFieldsName()).reduce(function(e,i){return(0,c.default)(e,i,t(i))},{})}},{key:\"getNestedField\",value:function(e,t){var i=this.getValidFieldsFullName(e);if(0===i.length||1===i.length&&i[0]===e)return t(e);var l=\"[\"===i[0][e.length],r=l?e.length:e.length+1;return i.reduce(function(e,i){return(0,c.default)(e,i.slice(r),t(i))},l?[]:{})}},{key:\"isValidNestedFieldName\",value:function(e){return this.getAllFieldsName().every(function(i){return!t(i,e)&&!t(e,i)})}},{key:\"clearField\",value:function(e){delete this.fields[e],delete this.fieldsMeta[e]}}]),e}(),m=function(){var e=this;this.setFieldsInitialValue=function(t){var i=e.flattenRegisteredFields(t),l=e.fieldsMeta;Object.keys(i).forEach(function(t){l[t]&&e.setFieldMeta(t,(0,u.default)({},e.getFieldMeta(t),{initialValue:i[t]}))})},this.getAllValues=function(){var t=e.fieldsMeta,i=e.fields;return Object.keys(t).reduce(function(t,l){return(0,c.default)(t,l,e.getValueFromFields(l,i))},{})},this.getFieldsValue=function(t){return e.getNestedFields(t,e.getFieldValue)},this.getFieldValue=function(t){var i=e.fields;return e.getNestedField(t,function(t){return e.getValueFromFields(t,i)})},this.getFieldsError=function(t){return e.getNestedFields(t,e.getFieldError)},this.getFieldError=function(t){return e.getNestedField(t,function(t){return(0,g.getErrorStrs)(e.getFieldMember(t,\"errors\"))})},this.isFieldValidating=function(t){return e.getFieldMember(t,\"validating\")},this.isFieldsValidating=function(t){return(t||e.getValidFieldsName()).some(function(t){return e.isFieldValidating(t)})},this.isFieldTouched=function(t){return e.getFieldMember(t,\"touched\")},this.isFieldsTouched=function(t){return(t||e.getValidFieldsName()).some(function(t){return e.isFieldTouched(t)})}};"},"hash":"fe8ff535fa3bf72731ea1077cbef64c5"}