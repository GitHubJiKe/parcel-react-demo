{"dependencies":[{"name":"babel-runtime/helpers/defineProperty","loc":{"line":1,"column":28}},{"name":"babel-runtime/helpers/extends","loc":{"line":2,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":5,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":6,"column":22}},{"name":"react","loc":{"line":7,"column":23}},{"name":"rc-upload","loc":{"line":8,"column":21}},{"name":"classnames","loc":{"line":9,"column":23}},{"name":"../locale-provider/LocaleReceiver","loc":{"line":10,"column":27}},{"name":"../locale-provider/default","loc":{"line":11,"column":26}},{"name":"./UploadList","loc":{"line":12,"column":23}},{"name":"./utils","loc":{"line":13,"column":76}}],"generated":{"js":"\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,\"__esModule\",{value:!0});var r=require(\"babel-runtime/helpers/defineProperty\"),a=t(r),s=require(\"babel-runtime/helpers/extends\"),o=t(s),l=require(\"babel-runtime/helpers/classCallCheck\"),i=t(l),n=require(\"babel-runtime/helpers/createClass\"),u=t(n),d=require(\"babel-runtime/helpers/possibleConstructorReturn\"),f=t(d),c=require(\"babel-runtime/helpers/inherits\"),p=t(c),v=require(\"react\"),h=e(v),m=require(\"rc-upload\"),g=t(m),L=require(\"classnames\"),b=t(L),y=require(\"../locale-provider/LocaleReceiver\"),P=t(y),U=require(\"../locale-provider/default\"),C=t(U),w=require(\"./UploadList\"),S=t(w),q=require(\"./utils\"),E=function(e){function t(e){(0,i.default)(this,t);var r=(0,f.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onStart=function(e){var t=void 0,a=r.state.fileList.concat();(t=(0,q.fileToObject)(e)).status=\"uploading\",a.push(t),r.onChange({file:t,fileList:a}),window.FormData||r.autoUpdateProgress(0,t)},r.onSuccess=function(e,t){r.clearProgressTimer();try{\"string\"==typeof e&&(e=JSON.parse(e))}catch(e){}var a=r.state.fileList,s=(0,q.getFileItem)(t,a);s&&(s.status=\"done\",s.response=e,r.onChange({file:(0,o.default)({},s),fileList:a}))},r.onProgress=function(e,t){var a=r.state.fileList,s=(0,q.getFileItem)(t,a);s&&(s.percent=e.percent,r.onChange({event:e,file:(0,o.default)({},s),fileList:r.state.fileList}))},r.onError=function(e,t,a){r.clearProgressTimer();var s=r.state.fileList,l=(0,q.getFileItem)(a,s);l&&(l.error=e,l.response=t,l.status=\"error\",r.onChange({file:(0,o.default)({},l),fileList:s}))},r.handleManualRemove=function(e){r.upload.abort(e),e.status=\"removed\",r.handleRemove(e)},r.onChange=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];\"fileList\"in r.props||!t||r.setState({fileList:e.fileList});var a=r.props.onChange;a&&a(e)},r.onFileDrop=function(e){r.setState({dragState:e.type})},r.beforeUpload=function(e,t){if(!r.props.beforeUpload)return!0;var a=r.props.beforeUpload(e,t);return!1===a?(r.onChange({file:e,fileList:t},!1),!1):!a||!a.then||a},r.saveUpload=function(e){r.upload=e},r.renderUploadList=function(e){var t=r.props,a=t.showUploadList,s=t.listType,l=t.onPreview,i=a.showRemoveIcon,n=a.showPreviewIcon;return h.createElement(S.default,{listType:s,items:r.state.fileList,onPreview:l,onRemove:r.handleManualRemove,showRemoveIcon:i,showPreviewIcon:n,locale:(0,o.default)({},e,r.props.locale)})},r.state={fileList:e.fileList||e.defaultFileList||[],dragState:\"drop\"},r}return(0,p.default)(t,e),(0,u.default)(t,[{key:\"componentWillUnmount\",value:function(){this.clearProgressTimer()}},{key:\"autoUpdateProgress\",value:function(e,t){var r=this,a=(0,q.genPercentAdd)(),s=0;this.clearProgressTimer(),this.progressTimer=setInterval(function(){s=a(s),r.onProgress({percent:s},t)},200)}},{key:\"handleRemove\",value:function(e){var t=this,r=this.props.onRemove;Promise.resolve(\"function\"==typeof r?r(e):r).then(function(r){if(!1!==r){var a=(0,q.removeFileItem)(e,t.state.fileList);a&&t.onChange({file:e,fileList:a})}})}},{key:\"componentWillReceiveProps\",value:function(e){\"fileList\"in e&&this.setState({fileList:e.fileList||[]})}},{key:\"clearProgressTimer\",value:function(){clearInterval(this.progressTimer)}},{key:\"render\",value:function(){var e,t=this.props,r=t.prefixCls,s=void 0===r?\"\":r,l=t.className,i=t.showUploadList,n=t.listType,u=t.type,d=t.disabled,f=t.children,c=(0,o.default)({onStart:this.onStart,onError:this.onError,onProgress:this.onProgress,onSuccess:this.onSuccess},this.props,{beforeUpload:this.beforeUpload});delete c.className;var p=i?h.createElement(P.default,{componentName:\"Upload\",defaultLocale:C.default.Upload},this.renderUploadList):null;if(\"drag\"===u){var v,m=(0,b.default)(s,(v={},(0,a.default)(v,s+\"-drag\",!0),(0,a.default)(v,s+\"-drag-uploading\",this.state.fileList.some(function(e){return\"uploading\"===e.status})),(0,a.default)(v,s+\"-drag-hover\",\"dragover\"===this.state.dragState),(0,a.default)(v,s+\"-disabled\",d),v));return h.createElement(\"span\",{className:l},h.createElement(\"div\",{className:m,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,onDragLeave:this.onFileDrop},h.createElement(g.default,(0,o.default)({},c,{ref:this.saveUpload,className:s+\"-btn\"}),h.createElement(\"div\",{className:s+\"-drag-container\"},f))),p)}var L=(0,b.default)(s,(e={},(0,a.default)(e,s+\"-select\",!0),(0,a.default)(e,s+\"-select-\"+n,!0),(0,a.default)(e,s+\"-disabled\",d),e)),y=h.createElement(\"div\",{className:L,style:{display:f?\"\":\"none\"}},h.createElement(g.default,(0,o.default)({},c,{ref:this.saveUpload})));return\"picture-card\"===n?h.createElement(\"span\",{className:l},p,y):h.createElement(\"span\",{className:l},y,p)}}]),t}(h.Component);exports.default=E,E.defaultProps={prefixCls:\"ant-upload\",type:\"select\",multiple:!1,action:\"\",data:{},accept:\"\",beforeUpload:q.T,showUploadList:!0,listType:\"text\",className:\"\",disabled:!1,supportServerRender:!0};"},"hash":"f76a03b04e64ca866818b70a285b842a"}