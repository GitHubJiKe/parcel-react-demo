{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":2,"column":28}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":3,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":4,"column":22}},{"name":"react","loc":{"line":5,"column":18}},{"name":"prop-types","loc":{"line":6,"column":22}},{"name":"classnames","loc":{"line":7,"column":23}},{"name":"./InputHandler","loc":{"line":8,"column":25}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(){}function n(e){e.preventDefault()}function o(e){return e.replace(/[^\\w\\.-]+/g,\"\")}Object.defineProperty(exports,\"__esModule\",{value:!0});var i=require(\"babel-runtime/helpers/extends\"),s=e(i),a=require(\"babel-runtime/helpers/classCallCheck\"),r=e(a),u=require(\"babel-runtime/helpers/possibleConstructorReturn\"),l=e(u),p=require(\"babel-runtime/helpers/inherits\"),d=e(p),c=require(\"react\"),f=e(c),h=require(\"prop-types\"),m=e(h),v=require(\"classnames\"),b=e(v),y=require(\"./InputHandler\"),g=e(y),N=200,x=600,M=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,C=function(e){function o(t){(0,r.default)(this,o);var n=(0,l.default)(this,e.call(this,t));w.call(n);var i=void 0;return i=\"value\"in t?t.value:t.defaultValue,i=n.toNumber(i),n.state={inputValue:n.toPrecisionAsStep(i),value:i,focused:t.autoFocus},n}return(0,d.default)(o,e),o.prototype.componentDidMount=function(){this.componentDidUpdate()},o.prototype.componentWillReceiveProps=function(e){if(\"value\"in e){var t=this.state.focused?e.value:this.getValidValue(e.value,e.min,e.max);this.setState({value:t,inputValue:this.inputting?t:this.toPrecisionAsStep(t)})}},o.prototype.componentWillUpdate=function(){try{this.start=this.input.selectionStart,this.end=this.input.selectionEnd}catch(e){}},o.prototype.componentDidUpdate=function(){if(this.props.focusOnUpDown&&this.state.focused){var e=this.input.setSelectionRange;e&&\"function\"==typeof e&&void 0!==this.start&&void 0!==this.end&&this.start!==this.end?this.input.setSelectionRange(this.start,this.end):this.focus()}},o.prototype.componentWillUnmount=function(){this.stop()},o.prototype.getCurrentValidValue=function(e){var t=e;return t=\"\"===t?\"\":this.isNotCompleteNumber(t)?this.state.value:this.getValidValue(t),this.toNumber(t)},o.prototype.getRatio=function(e){var t=1;return e.metaKey||e.ctrlKey?t=.1:e.shiftKey&&(t=10),t},o.prototype.getValueFromEvent=function(e){return e.target.value.trim().replace(/ã€‚/g,\".\")},o.prototype.getValidValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.min,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props.max,o=parseFloat(e,10);return isNaN(o)?e:(o<t&&(o=t),o>n&&(o=n),o)},o.prototype.setValue=function(e,t){var n=this.isNotCompleteNumber(parseFloat(e,10))?void 0:parseFloat(e,10),o=n!==this.state.value||\"\"+n!=\"\"+this.state.inputValue;\"value\"in this.props?this.setState({inputValue:this.toPrecisionAsStep(this.state.value)},t):this.setState({value:n,inputValue:this.toPrecisionAsStep(e)},t),o&&this.props.onChange(n)},o.prototype.getPrecision=function(e){if(\"precision\"in this.props)return this.props.precision;var t=e.toString();if(t.indexOf(\"e-\")>=0)return parseInt(t.slice(t.indexOf(\"e-\")+2),10);var n=0;return t.indexOf(\".\")>=0&&(n=t.length-t.indexOf(\".\")-1),n},o.prototype.getMaxPrecision=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(\"precision\"in this.props)return this.props.precision;var n=this.props.step,o=this.getPrecision(t),i=this.getPrecision(n),s=this.getPrecision(e);return e?Math.max(s,o+i):o+i},o.prototype.getPrecisionFactor=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getMaxPrecision(e,t);return Math.pow(10,n)},o.prototype.focus=function(){this.input.focus()},o.prototype.formatWrapper=function(e){return this.props.formatter?this.props.formatter(e):e},o.prototype.toPrecisionAsStep=function(e){if(this.isNotCompleteNumber(e)||\"\"===e)return e;var t=Math.abs(this.getMaxPrecision(e));return 0===t?e.toString():isNaN(t)?e.toString():Number(e).toFixed(t)},o.prototype.isNotCompleteNumber=function(e){return isNaN(e)||\"\"===e||null===e||e&&e.toString().indexOf(\".\")===e.toString().length-1},o.prototype.toNumber=function(e){return this.isNotCompleteNumber(e)?e:\"precision\"in this.props?Number(Number(e).toFixed(this.props.precision)):Number(e)},o.prototype.toNumberWhenUserInput=function(e){return(/\\.\\d*0$/.test(e)||e.length>16)&&this.state.focused?e:this.toNumber(e)},o.prototype.upStep=function(e,t){var n=this.props,o=n.step,i=n.min,s=this.getPrecisionFactor(e,t),a=Math.abs(this.getMaxPrecision(e,t)),r=void 0;return r=\"number\"==typeof e?((s*e+s*o*t)/s).toFixed(a):i===-1/0?o:i,this.toNumber(r)},o.prototype.downStep=function(e,t){var n=this.props,o=n.step,i=n.min,s=this.getPrecisionFactor(e,t),a=Math.abs(this.getMaxPrecision(e,t)),r=void 0;return r=\"number\"==typeof e?((s*e-s*o*t)/s).toFixed(a):i===-1/0?-o:i,this.toNumber(r)},o.prototype.step=function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments[3];this.stop(),t&&(t.persist(),t.preventDefault());var s=this.props;if(!s.disabled){var a=this.getCurrentValidValue(this.state.inputValue)||0;if(!this.isNotCompleteNumber(a)){var r=this[e+\"Step\"](a,o),u=r>s.max||r<s.min;r>s.max?r=s.max:r<s.min&&(r=s.min),this.setValue(r),this.setState({focused:!0}),u||(this.autoStepTimer=setTimeout(function(){n[e](t,o,!0)},i?N:x))}}},o.prototype.render=function(){var e,o=(0,s.default)({},this.props),i=o.prefixCls,a=o.disabled,r=o.readOnly,u=o.useTouch,l=(0,b.default)((e={},e[i]=!0,e[o.className]=!!o.className,e[i+\"-disabled\"]=a,e[i+\"-focused\"]=this.state.focused,e)),p=\"\",d=\"\",c=this.state.value;if(c||0===c)if(isNaN(c))p=i+\"-handler-up-disabled\",d=i+\"-handler-down-disabled\";else{var h=Number(c);h>=o.max&&(p=i+\"-handler-up-disabled\"),h<=o.min&&(d=i+\"-handler-down-disabled\")}var m=!o.readOnly&&!o.disabled,v=void 0;void 0!==(v=this.state.focused?this.state.inputValue:this.toPrecisionAsStep(this.state.value))&&null!==v||(v=\"\");var y=void 0,N=void 0;u?(y={onTouchStart:m&&!p?this.up:t,onTouchEnd:this.stop},N={onTouchStart:m&&!d?this.down:t,onTouchEnd:this.stop}):(y={onMouseDown:m&&!p?this.up:t,onMouseUp:this.stop,onMouseLeave:this.stop},N={onMouseDown:m&&!d?this.down:t,onMouseUp:this.stop,onMouseLeave:this.stop});var x=this.formatWrapper(v),M=!!p||a||r,C=!!d||a||r;return f.default.createElement(\"div\",{className:l,style:o.style,onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave,onMouseOver:o.onMouseOver,onMouseOut:o.onMouseOut},f.default.createElement(\"div\",{className:i+\"-handler-wrap\"},f.default.createElement(g.default,(0,s.default)({ref:\"up\",disabled:M,prefixCls:i,unselectable:\"unselectable\"},y,{role:\"button\",\"aria-label\":\"Increase Value\",\"aria-disabled\":!!M,className:i+\"-handler \"+i+\"-handler-up \"+p}),this.props.upHandler||f.default.createElement(\"span\",{unselectable:\"unselectable\",className:i+\"-handler-up-inner\",onClick:n})),f.default.createElement(g.default,(0,s.default)({ref:\"down\",disabled:C,prefixCls:i,unselectable:\"unselectable\"},N,{role:\"button\",\"aria-label\":\"Decrease Value\",\"aria-disabled\":!!C,className:i+\"-handler \"+i+\"-handler-down \"+d}),this.props.downHandler||f.default.createElement(\"span\",{unselectable:\"unselectable\",className:i+\"-handler-down-inner\",onClick:n}))),f.default.createElement(\"div\",{className:i+\"-input-wrap\",role:\"spinbutton\",\"aria-valuemin\":o.min,\"aria-valuemax\":o.max,\"aria-valuenow\":c},f.default.createElement(\"input\",{required:o.required,type:o.type,placeholder:o.placeholder,onClick:o.onClick,className:i+\"-input\",tabIndex:o.tabIndex,autoComplete:\"off\",onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:m?this.onKeyDown:t,onKeyUp:m?this.onKeyUp:t,autoFocus:o.autoFocus,maxLength:o.maxLength,readOnly:o.readOnly,disabled:o.disabled,max:o.max,min:o.min,step:o.step,name:o.name,id:o.id,onChange:this.onChange,ref:this.saveInput,value:x})))},o}(f.default.Component);C.propTypes={value:m.default.oneOfType([m.default.number,m.default.string]),defaultValue:m.default.oneOfType([m.default.number,m.default.string]),focusOnUpDown:m.default.bool,autoFocus:m.default.bool,onChange:m.default.func,onKeyDown:m.default.func,onKeyUp:m.default.func,prefixCls:m.default.string,tabIndex:m.default.string,disabled:m.default.bool,onFocus:m.default.func,onBlur:m.default.func,readOnly:m.default.bool,max:m.default.number,min:m.default.number,step:m.default.oneOfType([m.default.number,m.default.string]),upHandler:m.default.node,downHandler:m.default.node,useTouch:m.default.bool,formatter:m.default.func,parser:m.default.func,onMouseEnter:m.default.func,onMouseLeave:m.default.func,onMouseOver:m.default.func,onMouseOut:m.default.func,precision:m.default.number,required:m.default.bool},C.defaultProps={focusOnUpDown:!0,useTouch:!1,prefixCls:\"rc-input-number\",min:-M,step:1,style:{},onChange:t,onKeyDown:t,onFocus:t,onBlur:t,parser:o,required:!1};var w=function(){var e=this;this.onKeyDown=function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];if(38===t.keyCode){var s=e.getRatio(t);e.up(t,s),e.stop()}else if(40===t.keyCode){var a=e.getRatio(t);e.down(t,a),e.stop()}var r=e.props.onKeyDown;r&&r.apply(void 0,[t].concat(o))},this.onKeyUp=function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];e.stop();var s=e.props.onKeyUp;s&&s.apply(void 0,[t].concat(o))},this.onChange=function(t){e.state.focused&&(e.inputting=!0);var n=e.props.parser(e.getValueFromEvent(t));e.setState({inputValue:n}),e.props.onChange(e.toNumberWhenUserInput(n))},this.onFocus=function(){var t;e.setState({focused:!0}),(t=e.props).onFocus.apply(t,arguments)},this.onBlur=function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];e.inputting=!1,e.setState({focused:!1});var s=e.getCurrentValidValue(e.state.inputValue);t.persist(),e.setValue(s,function(){var n;(n=e.props).onBlur.apply(n,[t].concat(o))})},this.stop=function(){e.autoStepTimer&&clearTimeout(e.autoStepTimer)},this.down=function(t,n,o){e.step(\"down\",t,n,o)},this.up=function(t,n,o){e.step(\"up\",t,n,o)},this.saveInput=function(t){e.input=t}};exports.default=C;"},"hash":"26d491d2033e719eb7cb200aff180229"}