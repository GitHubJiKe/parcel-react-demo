{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"babel-runtime/helpers/defineProperty","loc":{"line":2,"column":28}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":5,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":6,"column":22}},{"name":"react","loc":{"line":7,"column":18}},{"name":"prop-types","loc":{"line":8,"column":22}},{"name":"./ChildrenUtils","loc":{"line":9,"column":120}},{"name":"./AnimateChild","loc":{"line":10,"column":25}},{"name":"./util","loc":{"line":12,"column":21}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function n(e){var n=e.children;return v.default.isValidElement(n)&&!n.key?v.default.cloneElement(n,{key:L}):n}function r(){}Object.defineProperty(exports,\"__esModule\",{value:!0});var t=require(\"babel-runtime/helpers/extends\"),i=e(t),a=require(\"babel-runtime/helpers/defineProperty\"),o=e(a),l=require(\"babel-runtime/helpers/classCallCheck\"),s=e(l),u=require(\"babel-runtime/helpers/createClass\"),d=e(u),f=require(\"babel-runtime/helpers/possibleConstructorReturn\"),p=e(f),h=require(\"babel-runtime/helpers/inherits\"),c=e(h),y=require(\"react\"),v=e(y),m=require(\"prop-types\"),E=e(m),C=require(\"./ChildrenUtils\"),k=require(\"./AnimateChild\"),b=e(k),A=require(\"./util\"),K=e(A),L=\"rc_animate_\"+Date.now(),g=function(e){function r(e){(0,s.default)(this,r);var t=(0,p.default)(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return P.call(t),t.currentlyAnimatingKeys={},t.keysToEnter=[],t.keysToLeave=[],t.state={children:(0,C.toArrayChildren)(n(e))},t.childrenRefs={},t}return(0,c.default)(r,e),(0,d.default)(r,[{key:\"componentDidMount\",value:function(){var e=this,n=this.props.showProp,r=this.state.children;n&&(r=r.filter(function(e){return!!e.props[n]})),r.forEach(function(n){n&&e.performAppear(n.key)})}},{key:\"componentWillReceiveProps\",value:function(e){var r=this;this.nextProps=e;var t=(0,C.toArrayChildren)(n(e)),i=this.props;i.exclusive&&Object.keys(this.currentlyAnimatingKeys).forEach(function(e){r.stop(e)});var a=i.showProp,l=this.currentlyAnimatingKeys,s=i.exclusive?(0,C.toArrayChildren)(n(i)):this.state.children,u=[];a?(s.forEach(function(e){var n=e&&(0,C.findChildInChildrenByKey)(t,e.key),r=void 0;(r=n&&n.props[a]||!e.props[a]?n:v.default.cloneElement(n||e,(0,o.default)({},a,!0)))&&u.push(r)}),t.forEach(function(e){e&&(0,C.findChildInChildrenByKey)(s,e.key)||u.push(e)})):u=(0,C.mergeChildren)(s,t),this.setState({children:u}),t.forEach(function(e){var n=e&&e.key;if(!e||!l[n]){var t=e&&(0,C.findChildInChildrenByKey)(s,n);if(a){var i=e.props[a];if(t){!(0,C.findShownChildInChildrenByKey)(s,n,a)&&i&&r.keysToEnter.push(n)}else i&&r.keysToEnter.push(n)}else t||r.keysToEnter.push(n)}}),s.forEach(function(e){var n=e&&e.key;if(!e||!l[n]){var i=e&&(0,C.findChildInChildrenByKey)(t,n);if(a){var o=e.props[a];if(i){!(0,C.findShownChildInChildrenByKey)(t,n,a)&&o&&r.keysToLeave.push(n)}else o&&r.keysToLeave.push(n)}else i||r.keysToLeave.push(n)}})}},{key:\"componentDidUpdate\",value:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var n=this.keysToLeave;this.keysToLeave=[],n.forEach(this.performLeave)}},{key:\"isValidChildByKey\",value:function(e,n){var r=this.props.showProp;return r?(0,C.findShownChildInChildrenByKey)(e,n,r):(0,C.findChildInChildrenByKey)(e,n)}},{key:\"stop\",value:function(e){delete this.currentlyAnimatingKeys[e];var n=this.childrenRefs[e];n&&n.stop()}},{key:\"render\",value:function(){var e=this,n=this.props;this.nextProps=n;var r=this.state.children,t=null;r&&(t=r.map(function(r){if(null===r||void 0===r)return r;if(!r.key)throw new Error(\"must set key for <rc-animate> children\");return v.default.createElement(b.default,{key:r.key,ref:function(n){return e.childrenRefs[r.key]=n},animation:n.animation,transitionName:n.transitionName,transitionEnter:n.transitionEnter,transitionAppear:n.transitionAppear,transitionLeave:n.transitionLeave},r)}));var a=n.component;if(a){var o=n;return\"string\"==typeof a&&(o=(0,i.default)({className:n.className,style:n.style},n.componentProps)),v.default.createElement(a,o,t)}return t[0]||null}}]),r}(v.default.Component);g.propTypes={component:E.default.any,componentProps:E.default.object,animation:E.default.object,transitionName:E.default.oneOfType([E.default.string,E.default.object]),transitionEnter:E.default.bool,transitionAppear:E.default.bool,exclusive:E.default.bool,transitionLeave:E.default.bool,onEnd:E.default.func,onEnter:E.default.func,onLeave:E.default.func,onAppear:E.default.func,showProp:E.default.string},g.defaultProps={animation:{},component:\"span\",componentProps:{},transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,onEnd:r,onEnter:r,onLeave:r,onAppear:r};var P=function(){var e=this;this.performEnter=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillEnter(e.handleDoneAdding.bind(e,n,\"enter\")))},this.performAppear=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillAppear(e.handleDoneAdding.bind(e,n,\"appear\")))},this.handleDoneAdding=function(r,t){var i=e.props;if(delete e.currentlyAnimatingKeys[r],!i.exclusive||i===e.nextProps){var a=(0,C.toArrayChildren)(n(i));e.isValidChildByKey(a,r)?\"appear\"===t?K.default.allowAppearCallback(i)&&(i.onAppear(r),i.onEnd(r,!0)):K.default.allowEnterCallback(i)&&(i.onEnter(r),i.onEnd(r,!0)):e.performLeave(r)}},this.performLeave=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillLeave(e.handleDoneLeaving.bind(e,n)))},this.handleDoneLeaving=function(r){var t=e.props;if(delete e.currentlyAnimatingKeys[r],!t.exclusive||t===e.nextProps){var i=(0,C.toArrayChildren)(n(t));if(e.isValidChildByKey(i,r))e.performEnter(r);else{var a=function(){K.default.allowLeaveCallback(t)&&(t.onLeave(r),t.onEnd(r,!1))};(0,C.isSameChildren)(e.state.children,i,t.showProp)?a():e.setState({children:i},a)}}}};exports.default=g;"},"hash":"2ce81067f4e11d52c23f98363eb90290"}