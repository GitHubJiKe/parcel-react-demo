{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"babel-runtime/helpers/defineProperty","loc":{"line":2,"column":28}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":5,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":6,"column":22}},{"name":"react","loc":{"line":9,"column":33}},{"name":"prop-types","loc":{"line":10,"column":22}},{"name":"classnames","loc":{"line":11,"column":23}},{"name":"./request","loc":{"line":12,"column":27}},{"name":"./uid","loc":{"line":13,"column":19}},{"name":"./attr-accept","loc":{"line":14,"column":23}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,\"__esModule\",{value:!0});var t=require(\"babel-runtime/helpers/extends\"),r=e(t),n=require(\"babel-runtime/helpers/defineProperty\"),o=e(n),a=require(\"babel-runtime/helpers/classCallCheck\"),l=e(a),u=require(\"babel-runtime/helpers/createClass\"),i=e(u),s=require(\"babel-runtime/helpers/possibleConstructorReturn\"),f=e(s),c=require(\"babel-runtime/helpers/inherits\"),d=e(c),p=require(\"react\"),h=e(p),b=require(\"prop-types\"),y=e(b),v=require(\"classnames\"),m=e(v),q=require(\"./request\"),k=e(q),C=require(\"./uid\"),g=e(C),D=require(\"./attr-accept\"),_=e(D),j=function(e){function t(){var e,r,n,o;(0,l.default)(this,t);for(var a=arguments.length,u=Array(a),i=0;i<a;i++)u[i]=arguments[i];return r=n=(0,f.default)(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.state={uid:(0,g.default)()},n.reqs={},n.onChange=function(e){var t=e.target.files;n.uploadFiles(t),n.reset()},n.onClick=function(){var e=n.fileInput;e&&e.click()},n.onKeyDown=function(e){\"Enter\"===e.key&&n.onClick()},n.onFileDrop=function(e){if(\"dragover\"!==e.type){var t=Array.prototype.slice.call(e.dataTransfer.files).filter(function(e){return(0,_.default)(e,n.props.accept)});n.uploadFiles(t),e.preventDefault()}else e.preventDefault()},n.saveFileInput=function(e){n.fileInput=e},o=r,(0,f.default)(n,o)}return(0,d.default)(t,e),(0,i.default)(t,[{key:\"componentDidMount\",value:function(){this._isMounted=!0}},{key:\"componentWillUnmount\",value:function(){this._isMounted=!1,this.abort()}},{key:\"uploadFiles\",value:function(e){var t=this,r=Array.prototype.slice.call(e);r.forEach(function(e){e.uid=(0,g.default)(),t.upload(e,r)})}},{key:\"upload\",value:function(e,t){var r=this,n=this.props;if(!n.beforeUpload)return setTimeout(function(){return r.post(e)},0);var o=n.beforeUpload(e,t);o&&o.then?o.then(function(t){var n=Object.prototype.toString.call(t);\"[object File]\"===n||\"[object Blob]\"===n?r.post(t):r.post(e)}).catch(function(e){console}):!1!==o&&setTimeout(function(){return r.post(e)},0)}},{key:\"post\",value:function(e){var t=this;if(this._isMounted){var r=this.props,n=r.data,o=r.onStart,a=r.onProgress;\"function\"==typeof n&&(n=n(e));var l=e.uid,u=r.customRequest||k.default;this.reqs[l]=u({action:r.action,filename:r.name,file:e,data:n,headers:r.headers,withCredentials:r.withCredentials,onProgress:a?function(t){a(t,e)}:null,onSuccess:function(n,o){delete t.reqs[l],r.onSuccess(n,e,o)},onError:function(n,o){delete t.reqs[l],r.onError(n,o,e)}}),o(e)}}},{key:\"reset\",value:function(){this.setState({uid:(0,g.default)()})}},{key:\"abort\",value:function(e){var t=this.reqs;if(e){var r=e;e&&e.uid&&(r=e.uid),t[r]&&(t[r].abort(),delete t[r])}else Object.keys(t).forEach(function(e){t[e]&&t[e].abort(),delete t[e]})}},{key:\"render\",value:function(){var e,t=this.props,n=t.component,a=t.prefixCls,l=t.className,u=t.disabled,i=t.style,s=t.multiple,f=t.accept,c=t.children,d=(0,m.default)((e={},(0,o.default)(e,a,!0),(0,o.default)(e,a+\"-disabled\",u),(0,o.default)(e,l,l),e)),p=u?{}:{onClick:this.onClick,onKeyDown:this.onKeyDown,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:\"0\"};return h.default.createElement(n,(0,r.default)({},p,{className:d,role:\"button\",style:i}),h.default.createElement(\"input\",{type:\"file\",ref:this.saveFileInput,key:this.state.uid,style:{display:\"none\"},accept:f,multiple:s,onChange:this.onChange}),c)}}]),t}(p.Component);j.propTypes={component:y.default.string,style:y.default.object,prefixCls:y.default.string,className:y.default.string,multiple:y.default.bool,disabled:y.default.bool,accept:y.default.string,children:y.default.any,onStart:y.default.func,data:y.default.oneOfType([y.default.object,y.default.func]),headers:y.default.object,beforeUpload:y.default.func,customRequest:y.default.func,onProgress:y.default.func,withCredentials:y.default.bool},exports.default=j;"},"hash":"f092d4e1d9dc6a4006056b8fadd24ad3"}