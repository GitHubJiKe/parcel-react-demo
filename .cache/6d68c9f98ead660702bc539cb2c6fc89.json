{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"react","loc":{"line":2,"column":18}},{"name":"create-react-class","loc":{"line":3,"column":29}},{"name":"prop-types","loc":{"line":4,"column":22}},{"name":"moment","loc":{"line":5,"column":19}},{"name":"classnames","loc":{"line":6,"column":23}},{"name":"./range-calendar/CalendarPart","loc":{"line":7,"column":25}},{"name":"./calendar/TodayButton","loc":{"line":8,"column":24}},{"name":"./calendar/OkButton","loc":{"line":9,"column":21}},{"name":"./calendar/TimePickerButton","loc":{"line":10,"column":29}},{"name":"./mixin/CommonMixin","loc":{"line":11,"column":24}},{"name":"./util/","loc":{"line":12,"column":54}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(){}function a(e){return Array.isArray(e)&&(0===e.length||e.every(function(e){return!e}))}function n(e,t){if(e===t)return!0;if(null===e||void 0===e||null===t||void 0===t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(e[a]!==t[a])return!1;return!0}function l(e){var t=e[0],a=e[1];return[t,a&&a.isSame(t,\"month\")?a.clone().add(1,\"month\"):a]}function i(e,t){var n=e.selectedValue||t&&e.defaultSelectedValue,i=e.value||t&&e.defaultValue,r=l(i||n);return a(r)?t&&[(0,V.default)(),(0,V.default)().add(1,\"months\")]:r}function r(e,t){for(var a=t?t():[],n=0;n<e;n++)-1===a.indexOf(n)&&a.push(n);return a}function s(e,t){if(t){var a=this.state.selectedValue.concat(),n=\"left\"===e?0:1;a[n]=t,a[0]&&this.compare(a[0],a[1])>0&&(a[1-n]=this.state.showTimePicker?a[n]:void 0),this.fireSelectValueChange(a)}}Object.defineProperty(exports,\"__esModule\",{value:!0});var o=require(\"babel-runtime/helpers/extends\"),u=e(o),d=require(\"react\"),h=e(d),c=require(\"create-react-class\"),f=e(c),m=require(\"prop-types\"),v=e(m),p=require(\"moment\"),V=e(p),S=require(\"classnames\"),g=e(S),y=require(\"./range-calendar/CalendarPart\"),T=e(y),b=require(\"./calendar/TodayButton\"),P=e(b),C=require(\"./calendar/OkButton\"),k=e(C),E=require(\"./calendar/TimePickerButton\"),w=e(E),D=require(\"./mixin/CommonMixin\"),O=e(D),M=require(\"./util/\"),A=(0,f.default)({displayName:\"RangeCalendar\",propTypes:{prefixCls:v.default.string,dateInputPlaceholder:v.default.any,defaultValue:v.default.any,value:v.default.any,hoverValue:v.default.any,mode:v.default.arrayOf(v.default.oneOf([\"date\",\"month\",\"year\",\"decade\"])),timePicker:v.default.any,showOk:v.default.bool,showToday:v.default.bool,defaultSelectedValue:v.default.array,selectedValue:v.default.array,onOk:v.default.func,showClear:v.default.bool,locale:v.default.object,onChange:v.default.func,onSelect:v.default.func,onValueChange:v.default.func,onHoverChange:v.default.func,onPanelChange:v.default.func,format:v.default.oneOfType([v.default.object,v.default.string]),onClear:v.default.func,type:v.default.any,disabledDate:v.default.func,disabledTime:v.default.func},mixins:[O.default],getDefaultProps:function(){return{type:\"both\",defaultSelectedValue:[],onValueChange:t,onHoverChange:t,onPanelChange:t,disabledTime:t,showToday:!0}},getInitialState:function(){var e=this.props,t=e.selectedValue||e.defaultSelectedValue,a=i(e,1);return{selectedValue:t,prevSelectedValue:t,firstSelectedValue:null,hoverValue:e.hoverValue||[],value:a,showTimePicker:!1,mode:e.mode||[\"date\",\"date\"]}},componentWillReceiveProps:function(e){var t=this.state,a={};\"value\"in e&&(a.value=i(e,0),this.setState(a)),\"hoverValue\"in e&&!n(t.hoverValue,e.hoverValue)&&this.setState({hoverValue:e.hoverValue}),\"selectedValue\"in e&&(a.selectedValue=e.selectedValue,a.prevSelectedValue=e.selectedValue,this.setState(a)),\"mode\"in e&&!n(t.mode,e.mode)&&this.setState({mode:e.mode})},onDatePanelEnter:function(){this.hasSelectedValue()&&this.fireHoverValueChange(this.state.selectedValue.concat())},onDatePanelLeave:function(){this.hasSelectedValue()&&this.fireHoverValueChange([])},onSelect:function(e){var t=this.props.type,a=this.state,n=a.selectedValue,l=a.prevSelectedValue,i=a.firstSelectedValue,r=void 0;if(\"both\"===t)i?this.compare(i,e)<0?((0,M.syncTime)(l[1],e),r=[i,e]):((0,M.syncTime)(l[0],e),(0,M.syncTime)(l[1],i),r=[e,i]):((0,M.syncTime)(l[0],e),r=[e]);else if(\"start\"===t){(0,M.syncTime)(l[0],e);var s=n[1];r=s&&this.compare(s,e)>0?[e,s]:[e]}else{var o=n[0];o&&this.compare(o,e)<=0?((0,M.syncTime)(l[1],e),r=[o,e]):((0,M.syncTime)(l[0],e),r=[e])}this.fireSelectValueChange(r)},onDayHover:function(e){var t=[],a=this.state,n=a.selectedValue,l=a.firstSelectedValue,i=this.props.type;if(\"start\"===i&&n[1])t=this.compare(e,n[1])<0?[e,n[1]]:[e];else if(\"end\"===i&&n[0])t=this.compare(e,n[0])>0?[n[0],e]:[];else{if(!l)return;t=this.compare(e,l)<0?[e,l]:[l,e]}this.fireHoverValueChange(t)},onToday:function(){var e=(0,M.getTodayTime)(this.state.value[0]),t=e.clone().add(1,\"months\");this.setState({value:[e,t]})},onOpenTimePicker:function(){this.setState({showTimePicker:!0})},onCloseTimePicker:function(){this.setState({showTimePicker:!1})},onOk:function(){var e=this.state.selectedValue;this.isAllowedDateAndTime(e)&&this.props.onOk(this.state.selectedValue)},onStartInputSelect:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=[\"left\"].concat(t);return s.apply(this,n)},onEndInputSelect:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=[\"right\"].concat(t);return s.apply(this,n)},onStartValueChange:function(e){var t=[].concat(this.state.value);return t[0]=e,this.fireValueChange(t)},onEndValueChange:function(e){var t=[].concat(this.state.value);return t[1]=e,this.fireValueChange(t)},onStartPanelChange:function(e,t){var a=this.props,n=this.state,l=[t,n.mode[1]];\"mode\"in a||this.setState({mode:l});var i=[e||n.value[0],n.value[1]];a.onPanelChange(i,l)},onEndPanelChange:function(e,t){var a=this.props,n=this.state,l=[n.mode[0],t];\"mode\"in a||this.setState({mode:l});var i=[n.value[0],e||n.value[1]];a.onPanelChange(i,l)},getStartValue:function(){var e=this.state.value[0],t=this.state.selectedValue;return t[0]&&this.props.timePicker&&(e=e.clone(),(0,M.syncTime)(t[0],e)),this.state.showTimePicker&&t[0]?t[0]:e},getEndValue:function(){var e=this.state,t=e.value,a=e.selectedValue,n=e.showTimePicker,l=t[1]?t[1].clone():t[0].clone().add(1,\"month\");return a[1]&&this.props.timePicker&&(0,M.syncTime)(a[1],l),n?a[1]?a[1]:this.getStartValue():l},getEndDisableTime:function(){var e=this.state,t=e.selectedValue,a=e.value,n=(0,this.props.disabledTime)(null,\"end\")||{},l=t&&t[0]||a[0].clone();if(!t[1]||l.isSame(t[1],\"day\")){var i=l.hour(),s=l.minute(),o=l.second(),u=n.disabledHours,d=n.disabledMinutes,h=n.disabledSeconds;return u=r(i,u),d=r(s,d),h=r(o,h),{disabledHours:function(){return u},disabledMinutes:function(e){return e===i?d:[]},disabledSeconds:function(e,t){return e===i&&t===s?h:[]}}}return n},isAllowedDateAndTime:function(e){return(0,M.isAllowedDate)(e[0],this.props.disabledDate,this.disabledStartTime)&&(0,M.isAllowedDate)(e[1],this.props.disabledDate,this.disabledEndTime)},isMonthYearPanelShow:function(e){return[\"month\",\"year\",\"decade\"].indexOf(e)>-1},hasSelectedValue:function(){var e=this.state.selectedValue;return!!e[1]&&!!e[0]},compare:function(e,t){return this.props.timePicker?e.diff(t):e.diff(t,\"days\")},fireSelectValueChange:function(e,t){var a=this.props.timePicker,n=this.state.prevSelectedValue;if(a&&a.props.defaultValue){var i=a.props.defaultValue;!n[0]&&e[0]&&(0,M.syncTime)(i[0],e[0]),!n[1]&&e[1]&&(0,M.syncTime)(i[1],e[1])}if(\"selectedValue\"in this.props||this.setState({selectedValue:e}),!this.state.selectedValue[0]||!this.state.selectedValue[1]){var r=e[0]||(0,V.default)(),s=e[1]||r.clone().add(1,\"months\");this.setState({selectedValue:e,value:l([r,s])})}e[0]&&!e[1]&&(this.setState({firstSelectedValue:e[0]}),this.fireHoverValueChange(e.concat())),this.props.onChange(e),(t||e[0]&&e[1])&&(this.setState({prevSelectedValue:e,firstSelectedValue:null}),this.fireHoverValueChange([]),this.props.onSelect(e))},fireValueChange:function(e){var t=this.props;\"value\"in t||this.setState({value:e}),t.onValueChange(e)},fireHoverValueChange:function(e){var t=this.props;\"hoverValue\"in t||this.setState({hoverValue:e}),t.onHoverChange(e)},clear:function(){this.fireSelectValueChange([],!0),this.props.onClear()},disabledStartTime:function(e){return this.props.disabledTime(e,\"start\")},disabledEndTime:function(e){return this.props.disabledTime(e,\"end\")},disabledStartMonth:function(e){var t=this.state.value;return e.isSameOrAfter(t[1],\"month\")},disabledEndMonth:function(e){var t=this.state.value;return e.isSameOrBefore(t[0],\"month\")},render:function(){var e,t,a=this.props,n=this.state,l=a.prefixCls,i=a.dateInputPlaceholder,r=a.timePicker,s=a.showOk,o=a.locale,d=a.showClear,c=a.showToday,f=a.type,m=n.hoverValue,v=n.selectedValue,p=n.mode,V=n.showTimePicker,S=(e={},e[a.className]=!!a.className,e[l]=1,e[l+\"-hidden\"]=!a.visible,e[l+\"-range\"]=1,e[l+\"-show-time-picker\"]=V,e[l+\"-week-number\"]=a.showWeekNumber,e),y=(0,g.default)(S),b={selectedValue:n.selectedValue,onSelect:this.onSelect,onDayHover:\"start\"===f&&v[1]||\"end\"===f&&v[0]||m.length?this.onDayHover:void 0},C=void 0,E=void 0;i&&(Array.isArray(i)?(C=i[0],E=i[1]):C=E=i);var D=!0===s||!1!==s&&!!r,O=(0,g.default)((t={},t[l+\"-footer\"]=!0,t[l+\"-range-bottom\"]=!0,t[l+\"-footer-show-ok\"]=D,t)),A=this.getStartValue(),x=this.getEndValue(),H=(0,M.getTodayTime)(A),N=H.month(),q=H.year(),I=A.year()===q&&A.month()===N||x.year()===q&&x.month()===N,B=A.clone().add(1,\"months\"),_=B.year()===x.year()&&B.month()===x.month();return h.default.createElement(\"div\",{ref:this.saveRoot,className:y,style:a.style,tabIndex:\"0\"},a.renderSidebar(),h.default.createElement(\"div\",{className:l+\"-panel\"},d&&v[0]&&v[1]?h.default.createElement(\"a\",{className:l+\"-clear-btn\",role:\"button\",title:o.clear,onClick:this.clear}):null,h.default.createElement(\"div\",{className:l+\"-date-panel\",onMouseLeave:\"both\"!==f?this.onDatePanelLeave:void 0,onMouseEnter:\"both\"!==f?this.onDatePanelEnter:void 0},h.default.createElement(T.default,(0,u.default)({},a,b,{hoverValue:m,direction:\"left\",disabledTime:this.disabledStartTime,disabledMonth:this.disabledStartMonth,format:this.getFormat(),value:A,mode:p[0],placeholder:C,onInputSelect:this.onStartInputSelect,onValueChange:this.onStartValueChange,onPanelChange:this.onStartPanelChange,timePicker:r,showTimePicker:V,enablePrev:!0,enableNext:!_||this.isMonthYearPanelShow(p[1])})),h.default.createElement(\"span\",{className:l+\"-range-middle\"},\"~\"),h.default.createElement(T.default,(0,u.default)({},a,b,{hoverValue:m,direction:\"right\",format:this.getFormat(),timePickerDisabledTime:this.getEndDisableTime(),placeholder:E,value:x,mode:p[1],onInputSelect:this.onEndInputSelect,onValueChange:this.onEndValueChange,onPanelChange:this.onEndPanelChange,timePicker:r,showTimePicker:V,disabledTime:this.disabledEndTime,disabledMonth:this.disabledEndMonth,enablePrev:!_||this.isMonthYearPanelShow(p[0]),enableNext:!0}))),h.default.createElement(\"div\",{className:O},a.renderFooter(),c||a.timePicker||D?h.default.createElement(\"div\",{className:l+\"-footer-btn\"},c?h.default.createElement(P.default,(0,u.default)({},a,{disabled:I,value:n.value[0],onToday:this.onToday,text:o.backToToday})):null,a.timePicker?h.default.createElement(w.default,(0,u.default)({},a,{showTimePicker:V,onOpenTimePicker:this.onOpenTimePicker,onCloseTimePicker:this.onCloseTimePicker,timePickerDisabled:!this.hasSelectedValue()||m.length})):null,D?h.default.createElement(k.default,(0,u.default)({},a,{onOk:this.onOk,okDisabled:!this.isAllowedDateAndTime(v)||!this.hasSelectedValue()||m.length})):null):null)))}});exports.default=A;"},"hash":"921c4dc38552ee24f7c496f0e71e23a5"}