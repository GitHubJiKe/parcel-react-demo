{"dependencies":[{"name":"babel-runtime/helpers/defineProperty","loc":{"line":1,"column":28}},{"name":"babel-runtime/helpers/extends","loc":{"line":2,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":5,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":6,"column":22}},{"name":"react","loc":{"line":8,"column":33}},{"name":"prop-types","loc":{"line":9,"column":22}},{"name":"react-dom","loc":{"line":10,"column":21}},{"name":"classnames","loc":{"line":11,"column":23}},{"name":"./uid","loc":{"line":12,"column":19}},{"name":"warning","loc":{"line":13,"column":20}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,\"__esModule\",{value:!0});var t=require(\"babel-runtime/helpers/defineProperty\"),n=e(t),a=require(\"babel-runtime/helpers/extends\"),i=e(a),o=require(\"babel-runtime/helpers/classCallCheck\"),r=e(o),u=require(\"babel-runtime/helpers/createClass\"),d=e(u),l=require(\"babel-runtime/helpers/possibleConstructorReturn\"),s=e(l),p=require(\"babel-runtime/helpers/inherits\"),f=e(p),m=require(\"react\"),c=e(m),h=require(\"prop-types\"),y=e(h),g=require(\"react-dom\"),v=e(g),b=require(\"classnames\"),I=e(b),k=require(\"./uid\"),N=e(k),C=require(\"warning\"),D=e(C),q={position:\"absolute\",top:0,opacity:0,filter:\"alpha(opacity=0)\",left:0,zIndex:9999},x=function(e){function t(){var e,n,a,i;(0,r.default)(this,t);for(var o=arguments.length,u=Array(o),d=0;d<o;d++)u[d]=arguments[d];return n=a=(0,s.default)(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),a.state={uploading:!1},a.file={},a.onLoad=function(){if(a.state.uploading){var e=a,t=e.props,n=e.file,i=void 0;try{var o=a.getIframeDocument(),r=o.getElementsByTagName(\"script\")[0];r&&r.parentNode===o.body&&o.body.removeChild(r),i=o.body.innerHTML,t.onSuccess(i,n)}catch(e){(0,D.default)(!1,\"cross domain error for Upload. Maybe server should return document.domain script. see Note from https://github.com/react-component/upload\"),i=\"cross-domain\",t.onError(e,null,n)}a.endUpload()}},a.onChange=function(){var e=a.getFormInputNode(),t=a.file={uid:(0,N.default)(),name:e.value};a.startUpload();var n=a.props;if(!n.beforeUpload)return a.post(t);var i=n.beforeUpload(t);i&&i.then?i.then(function(){a.post(t)},function(){a.endUpload()}):!1!==i?a.post(t):a.endUpload()},a.saveIframe=function(e){a.iframe=e},i=n,(0,s.default)(a,i)}return(0,f.default)(t,e),(0,d.default)(t,[{key:\"componentDidMount\",value:function(){this.updateIframeWH(),this.initIframe()}},{key:\"componentDidUpdate\",value:function(){this.updateIframeWH()}},{key:\"getIframeNode\",value:function(){return this.iframe}},{key:\"getIframeDocument\",value:function(){return this.getIframeNode().contentDocument}},{key:\"getFormNode\",value:function(){return this.getIframeDocument().getElementById(\"form\")}},{key:\"getFormInputNode\",value:function(){return this.getIframeDocument().getElementById(\"input\")}},{key:\"getFormDataNode\",value:function(){return this.getIframeDocument().getElementById(\"data\")}},{key:\"getFileForMultiple\",value:function(e){return this.props.multiple?[e]:e}},{key:\"getIframeHTML\",value:function(e){var t=\"\",n=\"\";if(e){t='<script>document.domain=\"'+e+'\";<\\/script>',n='<input name=\"_documentDomain\" value=\"'+e+'\" />'}return'\\n    <!DOCTYPE html>\\n    <html>\\n    <head>\\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\\n    <style>\\n    body,html {padding:0;margin:0;border:0;overflow:hidden;}\\n    </style>\\n    '+t+'\\n    </head>\\n    <body>\\n    <form method=\"post\"\\n    encType=\"multipart/form-data\"\\n    action=\"'+this.props.action+'\" id=\"form\"\\n    style=\"display:block;height:9999px;position:relative;overflow:hidden;\">\\n    <input id=\"input\" type=\"file\"\\n     name=\"'+this.props.name+'\"\\n     style=\"position:absolute;top:0;right:0;height:9999px;font-size:9999px;cursor:pointer;\"/>\\n    '+n+'\\n    <span id=\"data\"></span>\\n    </form>\\n    </body>\\n    </html>\\n    '}},{key:\"initIframeSrc\",value:function(){this.domain&&(this.getIframeNode().src=\"javascript:void((function(){\\n        var d = document;\\n        d.open();\\n        d.domain='\"+this.domain+\"';\\n        d.write('');\\n        d.close();\\n      })())\")}},{key:\"initIframe\",value:function(){var e=this.getIframeNode(),t=e.contentWindow,n=void 0;this.domain=this.domain||\"\",this.initIframeSrc();try{n=t.document}catch(a){this.domain=document.domain,this.initIframeSrc(),n=(t=e.contentWindow).document}n.open(\"text/html\",\"replace\"),n.write(this.getIframeHTML(this.domain)),n.close(),this.getFormInputNode().onchange=this.onChange}},{key:\"endUpload\",value:function(){this.state.uploading&&(this.file={},this.state.uploading=!1,this.setState({uploading:!1}),this.initIframe())}},{key:\"startUpload\",value:function(){this.state.uploading||(this.state.uploading=!0,this.setState({uploading:!0}))}},{key:\"updateIframeWH\",value:function(){var e=v.default.findDOMNode(this),t=this.getIframeNode();t.style.height=e.offsetHeight+\"px\",t.style.width=e.offsetWidth+\"px\"}},{key:\"abort\",value:function(e){if(e){var t=e;e&&e.uid&&(t=e.uid),t===this.file.uid&&this.endUpload()}else this.endUpload()}},{key:\"post\",value:function(e){var t=this.getFormNode(),n=this.getFormDataNode(),a=this.props.data,i=this.props.onStart;\"function\"==typeof a&&(a=a(e));var o=document.createDocumentFragment();for(var r in a)if(a.hasOwnProperty(r)){var u=document.createElement(\"input\");u.setAttribute(\"name\",r),u.value=a[r],o.appendChild(u)}n.appendChild(o),t.submit(),n.innerHTML=\"\",i(e)}},{key:\"render\",value:function(){var e,t=this.props,a=t.component,o=t.disabled,r=t.className,u=t.prefixCls,d=t.children,l=t.style,s=(0,i.default)({},q,{display:this.state.uploading||o?\"none\":\"\"}),p=(0,I.default)((e={},(0,n.default)(e,u,!0),(0,n.default)(e,u+\"-disabled\",o),(0,n.default)(e,r,r),e));return c.default.createElement(a,{className:p,style:(0,i.default)({position:\"relative\",zIndex:0},l)},c.default.createElement(\"iframe\",{ref:this.saveIframe,onLoad:this.onLoad,style:s}),d)}}]),t}(m.Component);x.propTypes={component:y.default.string,style:y.default.object,disabled:y.default.bool,prefixCls:y.default.string,className:y.default.string,accept:y.default.string,onStart:y.default.func,multiple:y.default.bool,children:y.default.any,data:y.default.oneOfType([y.default.object,y.default.func]),action:y.default.string,name:y.default.string},exports.default=x;"},"hash":"376d5beac63cad6cc9390746a34f16eb"}