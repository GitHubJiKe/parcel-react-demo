{"dependencies":[{"name":"babel-runtime/helpers/objectWithoutProperties","loc":{"line":1,"column":37}},{"name":"babel-runtime/helpers/defineProperty","loc":{"line":2,"column":28}},{"name":"babel-runtime/helpers/extends","loc":{"line":3,"column":21}},{"name":"babel-runtime/helpers/toConsumableArray","loc":{"line":4,"column":31}},{"name":"react","loc":{"line":5,"column":18}},{"name":"create-react-class","loc":{"line":6,"column":29}},{"name":"async-validator","loc":{"line":7,"column":27}},{"name":"warning","loc":{"line":8,"column":20}},{"name":"lodash/get","loc":{"line":9,"column":16}},{"name":"lodash/has","loc":{"line":10,"column":16}},{"name":"lodash/set","loc":{"line":11,"column":16}},{"name":"./createFieldsStore","loc":{"line":12,"column":30}},{"name":"./utils","loc":{"line":13,"column":158}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e.validateMessages,l=e.onFieldsChange,s=e.onValuesChange,n=e.mapProps,f=void 0===n?E.identity:n,h=e.mapPropsToFields,g=e.fieldNameProp,F=e.fieldMetaProp,p=e.fieldDataProp,m=e.formPropName,V=void 0===m?\"form\":m,b=e.withRef;return function(e){var n=(0,c.default)({displayName:\"Form\",mixins:t,getInitialState:function(){var e=this,t=h&&h(this.props);return this.fieldsStore=(0,P.default)(t||{}),this.instances={},this.cachedBind={},this.clearedFieldMetaCache={},[\"getFieldsValue\",\"getFieldValue\",\"setFieldsInitialValue\",\"getFieldsError\",\"getFieldError\",\"isFieldValidating\",\"isFieldsValidating\",\"isFieldsTouched\",\"isFieldTouched\"].forEach(function(t){return e[t]=function(){var i;return(i=e.fieldsStore)[t].apply(i,arguments)}}),{submitting:!1}},componentWillReceiveProps:function(e){h&&this.fieldsStore.updateFields(h(e))},onCollectCommon:function(e,t,i){var r=this.fieldsStore.getFieldMeta(e);if(r[t])r[t].apply(r,(0,o.default)(i));else if(r.originalProps&&r.originalProps[t]){var l;(l=r.originalProps)[t].apply(l,(0,o.default)(i))}var a=r.getValueFromEvent?r.getValueFromEvent.apply(r,(0,o.default)(i)):E.getValueFromEvent.apply(void 0,(0,o.default)(i));if(s&&a!==this.fieldsStore.getFieldValue(e)){var n=this.fieldsStore.getAllValues(),f={};n[e]=a,Object.keys(n).forEach(function(e){return(0,C.default)(f,e,n[e])}),s(this.props,(0,C.default)({},e,a),f)}var u=this.fieldsStore.getField(e);return{name:e,field:(0,d.default)({},u,{value:a,touched:!0}),fieldMeta:r}},onCollect:function(e,t){for(var i=arguments.length,r=Array(i>2?i-2:0),l=2;l<i;l++)r[l-2]=arguments[l];var s=this.onCollectCommon(e,t,r),n=s.name,o=s.field,f=s.fieldMeta.validate,u=(0,d.default)({},o,{dirty:(0,E.hasRules)(f)});this.setFields((0,a.default)({},n,u))},onCollectValidate:function(e,t){for(var i=arguments.length,r=Array(i>2?i-2:0),l=2;l<i;l++)r[l-2]=arguments[l];var a=this.onCollectCommon(e,t,r),s=a.field,n=a.fieldMeta,o=(0,d.default)({},s,{dirty:!0});this.validateFieldsInternal([o],{action:t,options:{firstFields:!!n.validateFirst}})},getCacheBind:function(e,t,i){this.cachedBind[e]||(this.cachedBind[e]={});var r=this.cachedBind[e];return r[t]||(r[t]=i.bind(this,e,t)),r[t]},getFieldDecorator:function(e,t){var i=this,r=this.getFieldProps(e,t);return function(t){var l=i.fieldsStore.getFieldMeta(e),a=t.props;return l.originalProps=a,l.ref=t.ref,u.default.cloneElement(t,(0,d.default)({},r,i.fieldsStore.getFieldValuePropValue(l)))}},getFieldProps:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error(\"Must call `getFieldProps` with valid name string!\");var r=(0,d.default)({name:e,trigger:q,valuePropName:\"value\",validate:[]},i),l=r.rules,a=r.trigger,s=r.validateTrigger,n=void 0===s?a:s,o=r.validate,f=this.fieldsStore.getFieldMeta(e);\"initialValue\"in r&&(f.initialValue=r.initialValue);var u=(0,d.default)({},this.fieldsStore.getFieldValuePropValue(r),{ref:this.getCacheBind(e,e+\"__ref\",this.saveRef)});g&&(u[g]=e);var h=(0,E.normalizeValidateRules)(o,l,n),c=(0,E.getValidateTriggers)(h);c.forEach(function(i){u[i]||(u[i]=t.getCacheBind(e,i,t.onCollectValidate))}),a&&-1===c.indexOf(a)&&(u[a]=this.getCacheBind(e,a,this.onCollect));var v=(0,d.default)({},f,r,{validate:h});return this.fieldsStore.setFieldMeta(e,v),F&&(u[F]=v),p&&(u[p]=this.fieldsStore.getField(e)),u},getFieldInstance:function(e){return this.instances[e]},getRules:function(e,t){var i=e.validate.filter(function(e){return!t||e.trigger.indexOf(t)>=0}).map(function(e){return e.rules});return(0,E.flattenArray)(i)},setFields:function(e){var t=this,i=this.fieldsStore.flattenRegisteredFields(e);if(this.fieldsStore.setFields(i),l){var r=Object.keys(i).reduce(function(e,i){return(0,C.default)(e,i,t.fieldsStore.getField(i))},{});l(this.props,r,this.fieldsStore.getNestedAllFields())}this.forceUpdate()},resetFields:function(e){var t=this.fieldsStore.resetFields(e);Object.keys(t).length>0&&this.setFields(t)},setFieldsValue:function(e){var t=this.fieldsStore.fieldsMeta,i=this.fieldsStore.flattenRegisteredFields(e),r=Object.keys(i).reduce(function(e,r){var l=t[r];if(l){var a=i[r];e[r]={value:a}}return e},{});if(this.setFields(r),s){var l=this.fieldsStore.getAllValues();s(this.props,e,l)}},saveRef:function(e,t,i){if(!i)return this.clearedFieldMetaCache[e]={field:this.fieldsStore.getField(e),meta:this.fieldsStore.getFieldMeta(e)},this.fieldsStore.clearField(e),delete this.instances[e],void delete this.cachedBind[e];this.clearedFieldMetaCache[e]&&(this.fieldsStore.setFields((0,a.default)({},e,this.clearedFieldMetaCache[e].field)),this.fieldsStore.setFieldMeta(e,this.clearedFieldMetaCache[e].meta)),delete this.clearedFieldMetaCache[e];var r=this.fieldsStore.getFieldMeta(e);if(r){var l=r.ref;if(l){if(\"string\"==typeof l)throw new Error(\"can not set ref string for \"+e);l(i)}}this.instances[e]=i},validateFieldsInternal:function(e,t,r){var l=this,a=t.fieldNames,s=t.action,n=t.options,o=void 0===n?{}:n,f={},u={},h={},c={};if(e.forEach(function(e){var t=e.name;if(!0===o.force||!1!==e.dirty){var i=l.fieldsStore.getFieldMeta(t),r=(0,d.default)({},e);r.errors=void 0,r.validating=!0,r.dirty=!0,f[t]=l.getRules(i,s),u[t]=r.value,h[t]=r}else e.errors&&(0,C.default)(c,t,{errors:e.errors})}),this.setFields(h),Object.keys(u).forEach(function(e){u[e]=l.fieldsStore.getFieldValue(e)}),r&&(0,E.isEmptyObject)(h))r((0,E.isEmptyObject)(c)?null:c,this.fieldsStore.getFieldsValue(a));else{var g=new v.default(f);i&&g.messages(i),g.validate(u,o,function(e){var t=(0,d.default)({},c);e&&e.length&&e.forEach(function(e){var i=e.field;(0,y.default)(t,i)||(0,C.default)(t,i,{errors:[]});(0,S.default)(t,i.concat(\".errors\")).push(e)});var i=[],s={};Object.keys(f).forEach(function(e){var r=(0,S.default)(t,e),a=l.fieldsStore.getField(e);a.value!==u[e]?i.push({name:e}):(a.errors=r&&r.errors,a.value=u[e],a.validating=!1,a.dirty=!1,s[e]=a)}),l.setFields(s),r&&(i.length&&i.forEach(function(e){var i=e.name,r=[{message:i+\" need to revalidate\",field:i}];(0,C.default)(t,i,{expired:!0,errors:r})}),r((0,E.isEmptyObject)(t)?null:t,l.fieldsStore.getFieldsValue(a)))})}},validateFields:function(e,t,i){var r=this,l=(0,E.getParams)(e,t,i),a=l.names,s=l.callback,d=l.options,n=a?this.fieldsStore.getValidFieldsFullName(a):this.fieldsStore.getValidFieldsName(),o=n.filter(function(e){var t=r.fieldsStore.getFieldMeta(e);return(0,E.hasRules)(t.validate)}).map(function(e){var t=r.fieldsStore.getField(e);return t.value=r.fieldsStore.getFieldValue(e),t});o.length?(\"firstFields\"in d||(d.firstFields=n.filter(function(e){return!!r.fieldsStore.getFieldMeta(e).validateFirst})),this.validateFieldsInternal(o,{fieldNames:n,options:d},s)):s&&s(null,this.fieldsStore.getFieldsValue(n))},isSubmitting:function(){return this.state.submitting},submit:function(e){var t=this;this.setState({submitting:!0}),e(function(){t.setState({submitting:!1})})},render:function(){var t=this.props,i=t.wrappedComponentRef,l=(0,r.default)(t,[\"wrappedComponentRef\"]),s=(0,a.default)({},V,this.getForm());b?s.ref=\"wrappedComponent\":i&&(s.ref=i);var n=f.call(this,(0,d.default)({},s,l));return u.default.createElement(e,n)}});return(0,E.argumentContainer)(n,e)}}Object.defineProperty(exports,\"__esModule\",{value:!0});var i=require(\"babel-runtime/helpers/objectWithoutProperties\"),r=e(i),l=require(\"babel-runtime/helpers/defineProperty\"),a=e(l),s=require(\"babel-runtime/helpers/extends\"),d=e(s),n=require(\"babel-runtime/helpers/toConsumableArray\"),o=e(n),f=require(\"react\"),u=e(f),h=require(\"create-react-class\"),c=e(h),g=require(\"async-validator\"),v=e(g),F=require(\"warning\"),p=e(F),m=require(\"lodash/get\"),S=e(m),V=require(\"lodash/has\"),y=e(V),b=require(\"lodash/set\"),C=e(b),M=require(\"./createFieldsStore\"),P=e(M),E=require(\"./utils\"),q=\"onChange\";exports.default=t;"},"hash":"9ba858a4d009b10383c6fad7f4a1e2fc"}