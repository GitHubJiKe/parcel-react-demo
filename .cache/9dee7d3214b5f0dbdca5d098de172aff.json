{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"react","loc":{"line":2,"column":18}},{"name":"prop-types","loc":{"line":3,"column":22}},{"name":"react-dom","loc":{"line":4,"column":42}},{"name":"create-react-class","loc":{"line":5,"column":29}},{"name":"rc-util/es/Dom/contains","loc":{"line":6,"column":21}},{"name":"rc-util/es/Dom/addEventListener","loc":{"line":7,"column":29}},{"name":"./Popup","loc":{"line":8,"column":18}},{"name":"./utils","loc":{"line":9,"column":97}},{"name":"rc-util/es/getContainerRenderMixin","loc":{"line":10,"column":36}},{"name":"rc-util/es/Portal","loc":{"line":11,"column":19}}],"generated":{"js":"\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}function t(){}function i(){return\"\"}function o(){return window.document}Object.defineProperty(exports,\"__esModule\",{value:!0});var n=require(\"babel-runtime/helpers/extends\"),s=e(n),u=require(\"react\"),p=e(u),r=require(\"prop-types\"),a=e(r),l=require(\"react-dom\"),c=require(\"create-react-class\"),h=e(c),d=require(\"rc-util/es/Dom/contains\"),f=e(d),m=require(\"rc-util/es/Dom/addEventListener\"),T=e(m),C=require(\"./Popup\"),g=e(C),b=require(\"./utils\"),v=require(\"rc-util/es/getContainerRenderMixin\"),M=e(v),P=require(\"rc-util/es/Portal\"),y=e(P),D=[\"onClick\",\"onMouseDown\",\"onTouchStart\",\"onMouseEnter\",\"onMouseLeave\",\"onFocus\",\"onBlur\",\"onContextMenu\"],x=!!l.createPortal,O=[];x||O.push((0,M.default)({autoMount:!1,isVisible:function(e){return e.state.popupVisible},isForceRender:function(e){return e.props.forceRender},getContainer:function(e){return e.getContainer()}}));var V=(0,h.default)({displayName:\"Trigger\",propTypes:{children:a.default.any,action:a.default.oneOfType([a.default.string,a.default.arrayOf(a.default.string)]),showAction:a.default.any,hideAction:a.default.any,getPopupClassNameFromAlign:a.default.any,onPopupVisibleChange:a.default.func,afterPopupVisibleChange:a.default.func,popup:a.default.oneOfType([a.default.node,a.default.func]).isRequired,popupStyle:a.default.object,prefixCls:a.default.string,popupClassName:a.default.string,popupPlacement:a.default.string,builtinPlacements:a.default.object,popupTransitionName:a.default.oneOfType([a.default.string,a.default.object]),popupAnimation:a.default.any,mouseEnterDelay:a.default.number,mouseLeaveDelay:a.default.number,zIndex:a.default.number,focusDelay:a.default.number,blurDelay:a.default.number,getPopupContainer:a.default.func,getDocument:a.default.func,forceRender:a.default.bool,destroyPopupOnHide:a.default.bool,mask:a.default.bool,maskClosable:a.default.bool,onPopupAlign:a.default.func,popupAlign:a.default.object,popupVisible:a.default.bool,maskTransitionName:a.default.oneOfType([a.default.string,a.default.object]),maskAnimation:a.default.string},mixins:O,getDefaultProps:function(){return{prefixCls:\"rc-trigger-popup\",getPopupClassNameFromAlign:i,getDocument:o,onPopupVisibleChange:t,afterPopupVisibleChange:t,onPopupAlign:t,popupClassName:\"\",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[]}},getInitialState:function(){var e=this.props,t=void 0;return t=\"popupVisible\"in e?!!e.popupVisible:!!e.defaultPopupVisible,this.prevPopupVisible=t,{popupVisible:t}},componentWillMount:function(){var e=this;D.forEach(function(t){e[\"fire\"+t]=function(i){e.fireEvents(t,i)}})},componentDidMount:function(){this.componentDidUpdate({},{popupVisible:this.state.popupVisible})},componentWillReceiveProps:function(e){var t=e.popupVisible;void 0!==t&&this.setState({popupVisible:t})},componentDidUpdate:function(e,t){var i=this.props,o=this.state,n=function(){t.popupVisible!==o.popupVisible&&i.afterPopupVisibleChange(o.popupVisible)};if(x||this.renderComponent(null,n),this.prevPopupVisible=t.popupVisible,o.popupVisible){var s=void 0;return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(s=i.getDocument(),this.clickOutsideHandler=(0,T.default)(s,\"mousedown\",this.onDocumentClick)),this.touchOutsideHandler||(s=s||i.getDocument(),this.touchOutsideHandler=(0,T.default)(s,\"touchstart\",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(s=s||i.getDocument(),this.contextMenuOutsideHandler1=(0,T.default)(s,\"scroll\",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=(0,T.default)(window,\"blur\",this.onContextMenuClose)))}this.clearOutsideHandler()},componentWillUnmount:function(){this.clearDelayTimer(),this.clearOutsideHandler()},onMouseEnter:function(e){this.fireEvents(\"onMouseEnter\",e),this.delaySetPopupVisible(!0,this.props.mouseEnterDelay)},onMouseLeave:function(e){this.fireEvents(\"onMouseLeave\",e),this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onPopupMouseEnter:function(){this.clearDelayTimer()},onPopupMouseLeave:function(e){e.relatedTarget&&!e.relatedTarget.setTimeout&&this._component&&this._component.getPopupDomNode&&(0,f.default)(this._component.getPopupDomNode(),e.relatedTarget)||this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onFocus:function(e){this.fireEvents(\"onFocus\",e),this.clearDelayTimer(),this.isFocusToShow()&&(this.focusTime=Date.now(),this.delaySetPopupVisible(!0,this.props.focusDelay))},onMouseDown:function(e){this.fireEvents(\"onMouseDown\",e),this.preClickTime=Date.now()},onTouchStart:function(e){this.fireEvents(\"onTouchStart\",e),this.preTouchTime=Date.now()},onBlur:function(e){this.fireEvents(\"onBlur\",e),this.clearDelayTimer(),this.isBlurToHide()&&this.delaySetPopupVisible(!1,this.props.blurDelay)},onContextMenu:function(e){e.preventDefault(),this.fireEvents(\"onContextMenu\",e),this.setPopupVisible(!0)},onContextMenuClose:function(){this.isContextMenuToShow()&&this.close()},onClick:function(e){if(this.fireEvents(\"onClick\",e),this.focusTime){var t=void 0;if(this.preClickTime&&this.preTouchTime?t=Math.min(this.preClickTime,this.preTouchTime):this.preClickTime?t=this.preClickTime:this.preTouchTime&&(t=this.preTouchTime),Math.abs(t-this.focusTime)<20)return;this.focusTime=0}this.preClickTime=0,this.preTouchTime=0,e.preventDefault();var i=!this.state.popupVisible;(this.isClickToHide()&&!i||i&&this.isClickToShow())&&this.setPopupVisible(!this.state.popupVisible)},onDocumentClick:function(e){if(!this.props.mask||this.props.maskClosable){var t=e.target,i=(0,l.findDOMNode)(this),o=this.getPopupDomNode();(0,f.default)(i,t)||(0,f.default)(o,t)||this.close()}},handlePortalUpdate:function(){this.prevPopupVisible!==this.state.popupVisible&&this.props.afterPopupVisibleChange(this.state.popupVisible)},getPopupDomNode:function(){return this._component&&this._component.getPopupDomNode?this._component.getPopupDomNode():null},getRootDomNode:function(){return(0,l.findDOMNode)(this)},getPopupClassNameFromAlign:function(e){var t=[],i=this.props,o=i.popupPlacement,n=i.builtinPlacements,s=i.prefixCls;return o&&n&&t.push((0,b.getPopupClassNameFromAlign)(n,s,e)),i.getPopupClassNameFromAlign&&t.push(i.getPopupClassNameFromAlign(e)),t.join(\" \")},getPopupAlign:function(){var e=this.props,t=e.popupPlacement,i=e.popupAlign,o=e.builtinPlacements;return t&&o?(0,b.getAlignFromPlacement)(o,t,i):i},getComponent:function(){var e=this.props,t=this.state,i={};return this.isMouseEnterToShow()&&(i.onMouseEnter=this.onPopupMouseEnter),this.isMouseLeaveToHide()&&(i.onMouseLeave=this.onPopupMouseLeave),p.default.createElement(g.default,(0,s.default)({prefixCls:e.prefixCls,destroyPopupOnHide:e.destroyPopupOnHide,visible:t.popupVisible,className:e.popupClassName,action:e.action,align:this.getPopupAlign(),onAlign:e.onPopupAlign,animation:e.popupAnimation,getClassNameFromAlign:this.getPopupClassNameFromAlign},i,{getRootDomNode:this.getRootDomNode,style:e.popupStyle,mask:e.mask,zIndex:e.zIndex,transitionName:e.popupTransitionName,maskAnimation:e.maskAnimation,maskTransitionName:e.maskTransitionName,ref:this.savePopup}),\"function\"==typeof e.popup?e.popup():e.popup)},getContainer:function(){var e=this.props,t=document.createElement(\"div\");t.style.position=\"absolute\",t.style.top=\"0\",t.style.left=\"0\",t.style.width=\"100%\";return(e.getPopupContainer?e.getPopupContainer((0,l.findDOMNode)(this)):e.getDocument().body).appendChild(t),t},setPopupVisible:function(e){this.clearDelayTimer(),this.state.popupVisible!==e&&(\"popupVisible\"in this.props||this.setState({popupVisible:e}),this.props.onPopupVisibleChange(e))},delaySetPopupVisible:function(e,t){var i=this,o=1e3*t;this.clearDelayTimer(),o?this.delayTimer=setTimeout(function(){i.setPopupVisible(e),i.clearDelayTimer()},o):this.setPopupVisible(e)},clearDelayTimer:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},clearOutsideHandler:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)},createTwoChains:function(e){var t=this.props.children.props,i=this.props;return t[e]&&i[e]?this[\"fire\"+e]:t[e]||i[e]},isClickToShow:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf(\"click\")||-1!==i.indexOf(\"click\")},isContextMenuToShow:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf(\"contextMenu\")||-1!==i.indexOf(\"contextMenu\")},isClickToHide:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf(\"click\")||-1!==i.indexOf(\"click\")},isMouseEnterToShow:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf(\"hover\")||-1!==i.indexOf(\"mouseEnter\")},isMouseLeaveToHide:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf(\"hover\")||-1!==i.indexOf(\"mouseLeave\")},isFocusToShow:function(){var e=this.props,t=e.action,i=e.showAction;return-1!==t.indexOf(\"focus\")||-1!==i.indexOf(\"focus\")},isBlurToHide:function(){var e=this.props,t=e.action,i=e.hideAction;return-1!==t.indexOf(\"focus\")||-1!==i.indexOf(\"blur\")},forcePopupAlign:function(){this.state.popupVisible&&this._component&&this._component.alignInstance&&this._component.alignInstance.forceAlign()},fireEvents:function(e,t){var i=this.props.children.props[e];i&&i(t);var o=this.props[e];o&&o(t)},close:function(){this.setPopupVisible(!1)},savePopup:function(e){x&&(this._component=e)},render:function(){var e=this.state.popupVisible,t=this.props,i=t.children,o=p.default.Children.only(i),n={key:\"trigger\"};this.isContextMenuToShow()?n.onContextMenu=this.onContextMenu:n.onContextMenu=this.createTwoChains(\"onContextMenu\"),this.isClickToHide()||this.isClickToShow()?(n.onClick=this.onClick,n.onMouseDown=this.onMouseDown,n.onTouchStart=this.onTouchStart):(n.onClick=this.createTwoChains(\"onClick\"),n.onMouseDown=this.createTwoChains(\"onMouseDown\"),n.onTouchStart=this.createTwoChains(\"onTouchStart\")),this.isMouseEnterToShow()?n.onMouseEnter=this.onMouseEnter:n.onMouseEnter=this.createTwoChains(\"onMouseEnter\"),this.isMouseLeaveToHide()?n.onMouseLeave=this.onMouseLeave:n.onMouseLeave=this.createTwoChains(\"onMouseLeave\"),this.isFocusToShow()||this.isBlurToHide()?(n.onFocus=this.onFocus,n.onBlur=this.onBlur):(n.onFocus=this.createTwoChains(\"onFocus\"),n.onBlur=this.createTwoChains(\"onBlur\"));var s=p.default.cloneElement(o,n);if(!x)return s;var u=void 0;return(e||this._component||t.forceRender)&&(u=p.default.createElement(y.default,{key:\"portal\",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),[s,u]}});exports.default=V;"},"hash":"a7e56cca3a7ed82753b6c7210ab55940"}